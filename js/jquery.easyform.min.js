/*!easyform v0.1 2013-11-08 */
(function(e,r){var t=function(r,t){function o(){var r=!0,t=!0;return e.each(u.fields,function(t,i){e(t).each(function(e,t){n(t,i)||(r=!1)})}),t=r&&f?f()===!1?!1:!0:!0,r&&t}var a,f,l={};e.isPlainObject(t)&&(a=t.submitButton||null,f="function"==typeof t.success?t.success:null,e.isArray(t.fields)?e.each(t.fields,function(e,r){l[r]={}}):e.isPlainObject(t.fields)?l=t.fields:"string"==typeof t.fields&&(l[t.fields]={})),this.fields=l;var u=this;r.each(function(){a?e(a,e(this)).bind("click",o):e(this).bind("submit",o)}),i(l),s()};t.prototype.removeFields=function(r){function t(r){delete o[r],e(r).removeClass("error").each(function(e,r){f(r),r.easyformBlur=!1})}var i,s=this,o=s.fields;return e.isArray(r)?e.each(r,function(e,r){o[r]&&t(r)}):"string"==typeof r&&(i=r,t(i)),s},t.prototype.addFields=function(r){var t=this,s={};if(e.isPlainObject(r))s=r;else if(e.isArray(r))e.each(r,function(e,r){s[r]={}});else if("string"==typeof r){var o=r;s[o]={}}return i(s),e.extend(t.fields,s),t};var i=function(r){e.each(r,function(r,t){e(r).each(function(r,i){i.easyformBlur||(i.easyformBlur=!0,e(i).bind("blur",function(){this.easyformBlur&&n(this,t)}))})})},s=function(){var t=null;e(r).bind("resize",function(){clearTimeout(t),t=setTimeout(function(){e(".error").each(function(e,r){l(r)})},200)})},o={email:/^(\w)+(\.\w+)*@(\w)+((\.\w+)+)$/,url:/(http|ftp|https):\/\/[\w\-_]+(\.[\w\-_]+)+([\w\-\.,@?^=%&amp;:/~\+#]*[\w\-\@?^=%&amp;/~\+#])?/},n=function(r,t){var i=!0,s=null,n=t.error||"内容不能为空",l=e.trim(e(r).val());if(""===l)i=a(r,n);else for(var u in t)if(e.isPlainObject(t[u])){var c=t[u];if(s="string"==typeof c.test?o[c.test]:c.test,n=c.message||"数据格式错误",!s.test(l)){i=a(r,n);break}}return i&&f(r),i},a=function(r,t){if(r.easyformError)r.easyformError.find(".easyform-error-message").text(t);else{var i=e('<div class="easyform-error"></div>'),s="rgb(215, 115, 115)",o=135,n="display:none;position: absolute; width: "+o+"px; background-color:"+s+"; color: #FFF; padding: 2px 8px; font-size: 13px; border-radius: 4px; line-height: 18px;",a="position:absolute;width:0;height:0;line-height:0;border-width:5px;border-style:dashed solid dashed dashed;border-color:transparent "+s+" transparent transparent;top:6px;left:-10px;",f="display: block; overflow: hidden; white-space: nowrap; text-overflow: ellipsis;";i.html('<em style="'+a+'"></em><span class="easyform-error-message" style="'+f+'">'+t+"</span>").appendTo(e("body")),r.easyformError=i,e(r).addClass("error"),i[0].style.cssText=n,l(r),i.fadeIn()}return!1},f=function(r){r.easyformError&&(r.easyformError.fadeOut(function(){e(this).remove()}),r.easyformError=null,e(r).removeClass("error"))},l=function(r){var t=r.easyformError;if(!t)return!1;var i=e(r).offset(),s=i.top,o=i.left,n=e(r).outerWidth(),a=e(r).outerHeight();t.css({top:s+(a-22)/2+"px",left:o+n+4+"px"})};e.fn.easyform=function(e){return new t(this,e)}})(this.jQuery,window);